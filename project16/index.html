<!DOCTYPE html>
<html lang="en">

<head>
    <title>QR Code Generator</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://pyscript.net/releases/2023.05.1/pyscript.css" />
    <link rel="stylesheet" href="styles.css" />
    <script defer src="https://pyscript.net/releases/2023.05.1/pyscript.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jsqr/dist/jsQR.js"></script>
    <!-- Bootstrap JS Bundle with Popper -->
    <script defer src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script defer src="script.js"></script>
</head>

<body>
    <py-config src="./pyscript.toml"></py-config>
    <py-script src="./main.py"></py-script>

    <div class="container py-4">
        <header class="mb-4">
            <h1 class="text-center mb-3">QR Code Generator</h1>
            <h2 class="text-center fs-5 mb-4 text-muted">with Watermark, Hidden Message and Digital Signature</h2>
            <nav>
                <ul class="nav nav-pills nav-fill mb-4">
                    <li class="nav-item">
                        <a class="nav-link active" href="#create">Create QR Code</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#decode">Decode QR Code</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#verify">Verify Signature</a>
                    </li>
                </ul>
            </nav>
        </header>

        <!-- Create QR Code Section -->
        <div id="create" class="page active">
            <div class="card mb-4">
                <div class="card-header">
                    <h2 class="mb-0 fs-4">Create QR Code</h2>
                </div>
                <div class="card-body">
                    <div class="mb-3">
                        <label for="qr_mode" class="form-label">QR Code Type:</label>
                        <select id="qr_mode" class="form-select py-input col-sm-8">
                            <option value="website">Website URL</option>
                            <option value="text">Plain Text</option>
                            <option value="contact">Contact Information</option>
                            <option value="email">Email</option>
                            <option value="wifi">WiFi Network</option>
                            <option value="location">Geographic Location</option>
                        </select>
                    </div>

                    <!-- Website URL Section -->
                    <div id="website-section" class="input-section active">
                        <div class="mb-3">
                            <label for="website_url" class="form-label">Website URL:</label>
                            <input id="website_url" class="form-control py-input" type="text" value="https://pyscript.com"
                                placeholder="https://example.com" />
                        </div>
                    </div>

                    <!-- Plain Text Section -->
                    <div id="text-section" class="input-section">
                        <div class="mb-3">
                            <label for="text_content" class="form-label">Text Content:</label>
                            <textarea id="text_content" class="form-control py-input" rows="3" placeholder="Enter your text message"></textarea>
                        </div>
                    </div>

                    <!-- Contact Section -->
                    <div id="contact-section" class="input-section">
                        <div class="mb-3">
                            <label for="contact_name" class="form-label">Name:</label>
                            <input id="contact_name" class="form-control py-input" type="text" placeholder="John Doe" />
                        </div>
                        <div class="mb-3">
                            <label for="contact_phone" class="form-label">Phone Number:</label>
                            <input id="contact_phone" class="form-control py-input" type="text" placeholder="+1234567890" />
                        </div>
                        <div class="mb-3">
                            <label for="contact_email" class="form-label">Email:</label>
                            <input id="contact_email" class="form-control py-input" type="text" placeholder="john@example.com" />
                        </div>
                        <div class="mb-3">
                            <label for="contact_address" class="form-label">Address:</label>
                            <textarea id="contact_address" class="form-control py-input" rows="2"
                                placeholder="123 Main St, City, Country"></textarea>
                        </div>
                        <div class="mb-3">
                            <label for="contact_website" class="form-label">Website:</label>
                            <input id="contact_website" class="form-control py-input" type="text" placeholder="https://example.com" />
                        </div>
                    </div>

                    <!-- Email Section -->
                    <div id="email-section" class="input-section">
                        <div class="mb-3">
                            <label for="email_address" class="form-label">Email Address:</label>
                            <input id="email_address" class="form-control py-input" type="text" placeholder="someone@example.com" />
                        </div>
                        <div class="mb-3">
                            <label for="email_subject" class="form-label">Subject:</label>
                            <input id="email_subject" class="form-control py-input" type="text" placeholder="Email Subject" />
                        </div>
                        <div class="mb-3">
                            <label for="email_body" class="form-label">Body:</label>
                            <textarea id="email_body" class="form-control py-input" rows="3" placeholder="Email body text"></textarea>
                        </div>
                    </div>

                    <!-- WiFi Section -->
                    <div id="wifi-section" class="input-section">
                        <div class="mb-3">
                            <label for="wifi_ssid" class="form-label">Network Name (SSID):</label>
                            <input id="wifi_ssid" class="form-control py-input" type="text" placeholder="WiFi Network Name" />
                        </div>
                        <div class="mb-3">
                            <label for="wifi_password" class="form-label">Password:</label>
                            <input id="wifi_password" class="form-control py-input" type="text" placeholder="WiFi Password" />
                        </div>
                        <div class="mb-3">
                            <label for="wifi_encryption" class="form-label">Encryption Type:</label>
                            <select id="wifi_encryption" class="form-select py-input">
                                <option value="WPA">WPA/WPA2</option>
                                <option value="WEP">WEP</option>
                                <option value="nopass">None</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="wifi_hidden" class="form-label">Hidden Network:</label>
                            <select id="wifi_hidden" class="form-select py-input">
                                <option value="false">No</option>
                                <option value="true">Yes</option>
                            </select>
                        </div>
                    </div>

                    <!-- Location Section -->
                    <div id="location-section" class="input-section">
                        <div class="mb-3">
                            <label for="location_latitude" class="form-label">Latitude:</label>
                            <input id="location_latitude" class="form-control py-input" type="text" placeholder="e.g., 37.7749" />
                        </div>
                        <div class="mb-3">
                            <label for="location_longitude" class="form-label">Longitude:</label>
                            <input id="location_longitude" class="form-control py-input" type="text" placeholder="e.g., -122.4194" />
                        </div>
                    </div>

                    <div class="mb-3">
                        <label for="hidden_message" class="form-label">Hidden Message:</label>
                        <input id="hidden_message" class="form-control py-input" type="text" value="SecretKey123" />
                    </div>

                    <!-- Ed25519 Digital Signature Section -->
                    <div class="mb-4 card">
                        <div class="card-header">
                            <h3 class="mb-0 fs-5">Digital Signature</h3>
                        </div>
                        <div class="card-body">
                            <div class="mb-3">
                                <label for="private-key-input" class="form-label">Upload ED25519 Private Key (Optional):</label>
                                <input type="file" id="private-key-input" class="form-control" />
                                <div id="key-status" class="form-text text-muted">No key loaded</div>
                            </div>
                            <div class="form-check">
                                <input type="checkbox" id="signature-checkbox" class="form-check-input" disabled />
                                <label for="signature-checkbox" class="form-check-label">Sign QR code content with ED25519</label>
                            </div>
                        </div>
                    </div>

                    <div class="mb-3">
                        <label for="watermark-input" class="form-label">Watermark Image (optional):</label>
                        <input type="file" id="watermark-input" class="form-control" accept="image/*" />
                        <div class="row align-items-center mt-2">
                            <div class="col-4 mb-2 mb-sm-0">
                                <img id="watermark-preview" class="img-thumbnail" alt="Watermark Preview" />
                            </div>
                            <div class="col-8">
                                <label for="watermark-opacity" class="form-label">Watermark Opacity:</label>
                                <input type="range" id="watermark-opacity" class="form-range" min="0.1" max="0.9" step="0.1" value="0.3" />
                            </div>
                        </div>
                    </div>

                    <button id="generate-btn" class="btn btn-primary py-button w-100" type="submit">Create QR Code</button>
                    <div id="status-message" class="mt-2 text-center"></div>
                </div>
            </div>

            <div class="card mb-4">
                <div class="card-header">
                    <h2 class="mb-0 fs-4">Generated QR Code:</h2>
                </div>
                <div class="card-body text-center">
                    <img id="qr_image" class="img-fluid mx-auto d-block border" />
                    <div class="mt-3">
                        <button id="decode-btn" class="btn btn-secondary py-button" type="submit">Decode Hidden Message</button>
                        <p id="decoded-message" class="mt-2">Hidden message will appear here.</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Decode QR Code Section -->
        <div id="decode" class="page">
            <div class="card mb-4">
                <div class="card-header">
                    <h2 class="mb-0 fs-4">Decode External QR Code</h2>
                </div>
                <div class="card-body">
                    <div class="mb-3">
                        <label for="decode-file-input" class="form-label">Upload a QR Code Image with Hidden Message:</label>
                        <input type="file" id="decode-file-input" class="form-control" accept="image/jpeg, image/png" />
                    </div>

                    <div class="text-center mb-3">
                        <h3 class="fs-5 mb-2">Uploaded QR Code:</h3>
                        <img id="decode-qr_image" class="img-fluid mx-auto d-block border" alt="Uploaded QR Code" />
                    </div>

                    <button id="decode-external-btn" class="btn btn-primary py-button w-100" type="submit">Decode Hidden Message</button>
                    <p id="decode-decoded-message" class="mt-2 text-center">Hidden message will appear here.</p>
                </div>
            </div>
        </div>

        <!-- Verify Signature Section -->
        <div id="verify" class="page">
            <div class="card mb-4">
                <div class="card-header">
                    <h2 class="mb-0 fs-4">Verify QR Code Signature</h2>
                </div>
                <div class="card-body">
                    <div class="mb-3">
                        <label for="verify-file-input" class="form-label">Upload a QR Code Image to Verify:</label>
                        <input type="file" id="verify-file-input" class="form-control" accept="image/jpeg, image/png" />
                    </div>

                    <div class="mb-3">
                        <label for="public-key-input" class="form-label">Upload ED25519 Public Key:</label>
                        <input type="file" id="public-key-input" class="form-control" />
                        <div id="verify-key-status" class="form-text text-muted">No key loaded</div>
                    </div>

                    <div class="text-center mb-3">
                        <h3 class="fs-5 mb-2">Uploaded QR Code:</h3>
                        <img id="verify-qr_image" class="img-fluid mx-auto d-block border" alt="Uploaded QR Code" />
                    </div>

                    <button id="verify-signature-btn" class="btn btn-primary py-button w-100" disabled>Verify Signature</button>
                    <p id="verification-result" class="mt-2 text-center">Load a QR code and public key to verify signature.</p>
                </div>
            </div>
        </div>

        <!-- Hidden fields needed for pyscript but not visible in the UI -->
        <div style="display: none;">
            <div id="website-section" class="input-section active"></div>
            <select id="qr_mode">
                <option value="text" selected>Plain Text</option>
            </select>
        </div>
    </div>
</body>

</html>